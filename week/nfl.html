<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1, viewport-fit=cover" />
<title>GameHub Live — Watch Now</title>
<style>
  :root{ --brand:#00d18a; --brand-2:#00b3ff; }
  *{box-sizing:border-box}
  html,body{height:100%; margin:0; background:#000;}
  /* Full-screen video */
  .player, video{
    position:fixed; inset:0; width:100vw; height:100vh;
    object-fit:cover; background:#000; display:block;
  }

  /* Unskippable modal gate */
  .modal{
    position:fixed; inset:0; z-index:10; display:flex; align-items:center; justify-content:center;
    background:rgba(0,0,0,.72); backdrop-filter: blur(10px) saturate(140%);
    opacity:0; pointer-events:none; transition:opacity .25s ease;
    padding: max(16px, env(safe-area-inset-top)) max(16px, env(safe-area-inset-right))
             max(16px, env(safe-area-inset-bottom)) max(16px, env(safe-area-inset-left));
  }
  .modal.show{ opacity:1; pointer-events:auto; }
  .card{
    width:min(640px, 94%); border-radius:18px; padding:18px;
    background:linear-gradient(180deg, rgba(13,17,23,.96), rgba(10,13,17,.96));
    color:#eaf0f6; border:1px solid rgba(255,255,255,.12);
    text-align:center; box-shadow:0 24px 60px rgba(0,0,0,.6);
  }
  .card h3{ margin:4px 0 8px; font: 800 22px/1.1 system-ui, -apple-system, Segoe UI, Roboto, Arial; }
  .card p{ margin:0 0 12px; color:#aab6c5; }
  .btn{
    display:inline-flex; align-items:center; justify-content:center; gap:10px;
    padding:12px 16px; font: 900 16px/1 system-ui, -apple-system, Segoe UI, Roboto, Arial;
    border-radius:12px; border:0; cursor:pointer; text-decoration:none;
    color:#041016; background:linear-gradient(135deg, var(--brand), var(--brand-2));
    box-shadow:0 14px 38px rgba(0,179,255,.45);
  }
  body.modal-open{ overflow:hidden; }
</style>
</head>

<body data-video-count="10" data-gate-delay="12000">
  <!-- Full-screen player -->
  <section class="player" aria-label="Live stream player">
    <video id="video" preload="metadata" autoplay muted playsinline webkit-playsinline controlslist="nodownload noplaybackrate">
      <source id="source" src="" type="video/mp4">
      Your browser does not support HTML5 video.
    </video>
  </section>

  <!-- Unskippable popup -->
  <div id="gate" class="modal" aria-hidden="true" role="dialog" aria-modal="true" tabindex="-1">
    <div class="card" role="document">
      <h3>Create your account to continue</h3>
      <p>It takes less than a minute. You’ll be right back to the game.</p>
      <div class="actions">
        <a id="register" class="btn" href="https://nba14.com/" rel="nofollow noopener" target="_self">Continue →</a>
      </div>
    </div>
  </div>

<script>
  /* ===== Hide native controls on hover devices (keep on touch) ===== */
  (function(){
    const video = document.getElementById('video');
    if (window.matchMedia && window.matchMedia('(hover: hover)').matches){
      video.removeAttribute('controls');
      video.setAttribute('disablepictureinpicture', '');
    } else {
      // Keep minimal controls on touch so users can interact if needed
      video.setAttribute('controls', '');
    }
  })();

  /* ===== Playlist Rotation: video1.mp4 ... videoN.mp4 ===== */
  (function(){
    const count = parseInt(document.body.getAttribute('data-video-count') || '1', 10);
    const files = Array.from({length: count}, (_, i) => `video${i+1}.mp4`);
    const key = 'currentVideoIndexMP4';
    let idx = Number(localStorage.getItem(key) || 0);
    if (!Number.isInteger(idx) || idx < 0 || idx >= files.length) idx = 0;

    const video = document.getElementById('video');
    const source = document.getElementById('source');

    function load(i){
      source.src = files[i];
      video.load();
      video.play().catch(()=>{ /* gesture policy */ });
    }

    let errors = 0;
    video.addEventListener('error', ()=>{
      errors++;
      if (errors < files.length){
        idx = (idx + 1) % files.length;
        load(idx);
      }
    });

    // Simple click-to-unmute with iOS unlock (no visible UI)
    const AC = window.AudioContext || window.webkitAudioContext;
    const audioCtx = AC ? new AC() : null;
    async function unlockAndUnmute(){
      try{ if (audioCtx && audioCtx.state !== 'running') await audioCtx.resume(); }catch(_){}
      try{ video.muted = false; video.defaultMuted = false; if (video.volume === 0) video.volume = 1; }catch(_){}
      try{ await video.play(); }catch(_){}
    }
    video.addEventListener('click', unlockAndUnmute, {passive:true});
    document.addEventListener('touchend', unlockAndUnmute, {once:true, passive:true});

    load(idx);
    localStorage.setItem(key, ((idx + 1) % files.length).toString());
  })();

  /* ===== Unskippable Register Gate ===== */
  (function(){
    const gate = document.getElementById('gate');
    const register = document.getElementById('register');
    const delay = parseInt(document.body.getAttribute('data-gate-delay') || '12000', 10);
    const video = document.getElementById('video');

    function lockScroll(on){ document.body.classList.toggle('modal-open', !!on); }

    // Force-exit any fullscreen / PiP / iOS presentation modes so the popup is visible
    function ensureExitFullscreen(){
      try{
        if (video){
          if (typeof video.webkitSupportsFullscreen !== 'undefined' && video.webkitDisplayingFullscreen){
            try{ video.webkitExitFullscreen(); }catch(_){}
          }
          if (typeof video.webkitPresentationMode === 'string' && video.webkitPresentationMode !== 'inline'){
            try{ video.webkitSetPresentationMode('inline'); }catch(_){}
          }
        }
        const d = document;
        if (d.fullscreenElement){ d.exitFullscreen().catch(()=>{}); }
        else if (d.webkitFullscreenElement && d.webkitExitFullscreen){ d.webkitExitFullscreen(); }
        else if (d.mozFullScreenElement && d.mozCancelFullScreen){ d.mozCancelFullScreen(); }
        else if (d.msFullscreenElement && d.msExitFullscreen){ d.msExitFullscreen(); }
        if ('pictureInPictureElement' in d && d.pictureInPictureElement){
          d.exitPictureInPicture().catch(()=>{});
        }
      }catch(_){}
    }

    function show(){
      ensureExitFullscreen();
      gate.classList.add('show');
      gate.setAttribute('aria-hidden','false');
      lockScroll(true);
      setTimeout(()=> register.focus({preventScroll:true}), 30);
    }

    let started = false;
    function start(){ if (started) return; started = true; setTimeout(show, delay); }
    document.addEventListener('DOMContentLoaded', start);
    window.addEventListener('load', start);

    document.addEventListener('fullscreenchange', ()=>{ if (gate.classList.contains('show')) ensureExitFullscreen(); });
    if (video){
      video.addEventListener('webkitbeginfullscreen', ()=>{ if (gate.classList.contains('show')) ensureExitFullscreen(); });
      video.addEventListener('webkitpresentationmodechanged', ()=>{ if (gate.classList.contains('show')) ensureExitFullscreen(); });
    }

    // Block Esc from dismissing
    document.addEventListener('keydown', (e)=>{ if (e.key === 'Escape'){ e.preventDefault(); e.stopPropagation(); }});
  })();
</script>
</body>
</html>
